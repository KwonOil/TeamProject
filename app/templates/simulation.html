<!-- app/templates/simulation.html -->
<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/static/css/dashboard.css">
    <!-- 시뮬레이션 전용 JS -->
    <script src="/static/js/simulation.js" defer></script>
</head>

<body>

<div id="sidebar">
    <h3>Simulation Robot List</h3>
    {# 시뮬레이션 DB에서 가져온 로봇 이름 목록 #}
    {% for name in robots %}
    <div class="robot-tab {% if name == initial_robot %}active{% endif %}"
            data-robot="{{ name }}">
            {{ name }}
        </div>
    {% endfor %}
</div>

<div id="main">
    <a href="/home">선택 화면으로 이동</a>
    <h2>Simulation Dashboard</h2>
    <div>선택된 로봇: <span id="currentRobotName">{{ initial_robot }}</span></div>

    <!-- 실시간 영상 (YOLO 결과용 오버레이 포함) -->
    <div style="position: relative; width:640px; height:480px;">
        <img id="cam" width="640" height="480"/>
        <canvas id="overlay"
                width="640"
                height="480"
                style="position:absolute; left:0; top:0;">
        </canvas>
    </div>

    <!-- 로봇 상태 -->
    <div class="card">
        <h3>현재 상태</h3>
        <div>배터리: <span id="batteryText">-</span></div>
        <div>위치 (X,Y): <span id="posText">-</span></div>
        <div>속도 (m/s): <span id="velText">-</span></div>
        <div>각속도 (rad/s): <span id="angVelText">-</span></div>
    </div>
    
    <!-- 라이다 요약 -->
    <div class="card">
        <h3>현재 라이다 상태</h3>
        <canvas id="lidarCanvas"
                width="500"
                height="500"
                style="background:#fafafa; border:1px solid #ddd;">
        </canvas>
    </div>

    <!-- 필요하면 경로 페이지로 이동 버튼 등 추가 가능 -->
    <button id="movePathBtn" class="path-btn">이동경로 보기</button>

</div>

<script>
    // JS 에서 최초 로봇 이름을 사용할 수 있게 전역으로 전달
    window.INITIAL_ROBOT_NAME = "{{ initial_robot or '' }}";
</script>

</body>
</html>
